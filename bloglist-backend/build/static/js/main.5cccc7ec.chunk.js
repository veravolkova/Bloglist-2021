(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),l=n(15),i=n(18),u=n(7),s=n.n(u),m=n(12),f=n(19),p=n(14),d=n(149),g=n(152),b=n(154),E=n(164),h=n(150),v=n(153),O=n(151),y=n(107),w=n(35),j=n(23),k=n(24),x=n.n(k),N="/api/blogs",T=null,S={getAll:function(){return x.a.get(N).then((function(e){return e.data}))},create:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:T}},e.next=3,x.a.post(N,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return x.a.put("".concat(N,"/").concat(e),t).then((function(e){return e.data}))},comment:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:T}},console.log("service",n),e.next=4,x.a.post("".concat(N,"/").concat(t,"/comments"),n,a);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(e){var t={headers:{Authorization:T}};return x.a.delete("".concat(N,"/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){T="bearer ".concat(e)}},I=function(){return function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},B=function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Object(w.a)({},t,{likes:t.likes+1}),n.next=3,S.update(e,r);case 3:c=n.sent,a({type:"ADD_LIKE",data:c});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},D=function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.comment(e.id,t);case 2:r=n.sent,a({type:"ADD_COMMENT",data:{newComment:r,blog:e}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},L=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.remove(e);case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(j.a)(e),[t.data]);case"ADD_LIKE":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(w.a)({},a,{likes:a.likes+1});return e.map((function(e){return e.id!==n?e:r}));case"ADD_COMMENT":var c=t.data.newComment,o=e.find((function(e){return e.id===t.data.blog.id})),l=Object(w.a)({},o,{comments:[].concat(Object(j.a)(o.comments),[c])});return e.map((function(e){return e.id===l.id?l:e}));case"DELETE_BLOG":var i=t.data;return e.filter((function(e){return e.id!==i}));default:return e}},A={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},_=function(){return function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},F={message:"",messageType:"",seconds:0},G=function(e,t,n){return console.log(e),function(){var a=Object(m.a)(s.a.mark((function a(r){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r({type:"SET_NOTIFICATION",data:{message:e,messageType:t,timeout:setTimeout((function(){r(J())}),1e3*n)}});case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},J=function(){return{type:"HIDE_NOTIFICATION"}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return clearTimeout(e.timeout),console.log(t.type),t.data;case"HIDE_NOTIFICATION":return F;default:return e}},W=n(106);function M(e){return r.a.createElement(W.a,{onClick:e.handleClick,color:e.color},e.text)}var R=function(e){var t=e.comment.commentText;return e.comment?r.a.createElement(r.a.Fragment,null,t):null},H=Object(d.a)({root:{minWidth:275,marginTop:25,marginBottom:25},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}),P={initializeUsers:_,initializeBlogs:I,setNotification:G,removeBlog:L},K=Object(l.b)((function(e){return{users:e.users}}),P)((function(e){var t=e.blog,n=e.users,c=e.blogVisible,o=e.setNotification,u=Object(a.useState)(""),d=Object(f.a)(u,2),w=d[0],j=d[1],k=Object(l.c)(),x=Object(p.f)(),N=H();Object(a.useEffect)((function(){k(I()),k(_())}),[k]);var T=Object(l.d)((function(e){return e.login})),S=n.find((function(e){return e.id===T.id}));if(!t||!S)return null;var C=function(){var e=Object(m.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault();try{k(D(t,{commentText:w})),j("")}catch(a){console.error(a)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=r.a.createElement(r.a.Fragment,null,r.a.createElement(i.b,{key:t.id,to:"/blogs/".concat(t.id)},t.title),r.a.createElement("br",null)),A=r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{className:N.root},r.a.createElement(O.a,null,r.a.createElement(y.a,{variant:"h5",component:"h2"},t.title),r.a.createElement(y.a,{className:N.pos,color:"textSecondary"},t.author),r.a.createElement(g.a,{href:t.url},t.url),r.a.createElement(y.a,null),r.a.createElement(y.a,{variant:"body2",component:"p"},t.likes," likes")),r.a.createElement(v.a,null,r.a.createElement(b.a,{color:"primary","aria-label":"outlined primary button group"},r.a.createElement(M,{handleClick:function(e){e.preventDefault(),function(e){try{var t=e.id,n={title:e.title,author:e.author,url:e.url,user:e.user.id,likes:e.likes+1};k(B(t,n)),o("Number of likes for entry ".concat(e.title," was updated"),"success",5)}catch(a){o("Smth went wrong","error",5)}}(t)},text:"like"}),r.a.createElement("br",null),S.blogs.find((function(e){return e.id===t.id}))?r.a.createElement(M,{handleClick:function(e){e.preventDefault(),function(e){if(window.confirm("Delete ".concat(e.title,"?")))try{k(L(e.id)),o("Entry ".concat(e.title," was removed"),"success",5),x.push("/blogs")}catch(t){o("Entry '".concat(e.title,"' can't be removed from server. Unauthorized"),"error",5)}}(t)},text:"remove blog",color:"secondary"}):null))),r.a.createElement(y.a,{variant:"h5",component:"h2"},"Add comment:"),r.a.createElement(E.a,{label:"comment",type:"text",value:w,name:"commentText",onChange:function(e){var t=e.target;return j(t.value)}}),r.a.createElement(M,{text:"comment",handleClick:C}),t.comments&&r.a.createElement("ul",null,t.comments.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(R,{comment:e}))}))));return r.a.createElement("div",{id:"blog"},c?r.a.createElement("div",{className:"maxDetails"},A):r.a.createElement("div",{className:"minDetails"},U))})),q=n(155),Q=n(69),X=n(156),Y=n(157),Z=n(158),$=n(159),ee=Object(l.b)((function(e){return{blogs:e.blogs}}),null)((function(e){return r.a.createElement("div",null,r.a.createElement(q.a,{component:Q.a},r.a.createElement(X.a,null,r.a.createElement(Y.a,null,e.blogs.sort((function(e,t){return e.likes<t.likes?1:-1})).map((function(e){return r.a.createElement(Z.a,{key:e.id},r.a.createElement($.a,null,r.a.createElement(K,{blog:e,blogVisible:!1})))}))))))})),te=n(16),ne=function(e){var t=e.createBlogEntry,n=Object(a.useState)({title:"",author:"",url:""}),c=Object(f.a)(n,2),o=c[0],l=c[1],i=Object(p.f)(),u=function(e){var t=e.target,n=t.name,a=t.value;l(Object(w.a)({},o,Object(te.a)({},n,a)))};return r.a.createElement("div",{className:"formDiv"},r.a.createElement("h4",null,"Create a new entry"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:o.title,author:o.author,url:o.url}),i.push("/blogs"),l({title:"",author:"",url:""})}},r.a.createElement("div",null,r.a.createElement(E.a,{label:"title",type:"text",id:"title",value:o.title,name:"title",onChange:u})),r.a.createElement("div",null,r.a.createElement(E.a,{label:"author",type:"text",id:"author",value:o.author,name:"author",onChange:u})),r.a.createElement("div",null,r.a.createElement(E.a,{label:"url",type:"text",id:"url",value:o.url,name:"url",onChange:u})),r.a.createElement(W.a,{type:"submit"},"save")))},ae=function(){return r.a.createElement("div",{style:{color:"grey",fontStyle:"italic",fontSize:16,backgroundColor:"#F8F8F8",borderTop:"1px solid #E7E7E7",textAlign:"center",padding:"20px",position:"fixed",left:"0",bottom:"0",height:"60px",width:"100%"}},r.a.createElement("br",null),r.a.createElement("em",null,"Blog app, Vera Popova 2020"))},re=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,a=e.handlePasswordChange,c=e.username,o=e.password;return r.a.createElement("div",{style:{marginTop:"20px"}},r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,r.a.createElement(E.a,{label:"username",id:"username",value:c,onChange:n})),r.a.createElement("div",null,r.a.createElement(E.a,{label:"password",id:"password",type:"password",value:o,onChange:a})),r.a.createElement(W.a,{type:"submit",id:"login-button"},"login")))},ce=n(160),oe=n(161),le=Object(d.a)((function(){return{root:{flexGrow:1},title:{flexGrow:1}}})),ie=function(e){var t=e.user,n=e.handleLogout,a=le();return r.a.createElement("div",{className:a.root},r.a.createElement(ce.a,{position:"static"},r.a.createElement(oe.a,null,r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/"},"home"),r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/blogs"},"blogs"),r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/create"},"create"),r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/users"},"users"),t?r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/logout",onClick:n},"logout"):r.a.createElement(W.a,{color:"inherit",component:i.b,to:"/login"},"login"))))},ue=n(165),se=Object(l.b)((function(e){return{notification:e.notification}}),null)((function(e){return r.a.createElement(ue.a,{severity:e.notification.messageType},e.notification.message)})),me=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(f.a)(n,2),o=c[0],l=c[1],i={display:o?"none":""},u={display:o?"":"none"},s=function(){l(!o)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),r.a.createElement("div",null,r.a.createElement("div",{style:i},r.a.createElement(W.a,{onClick:s},e.buttonLabel)),r.a.createElement("div",{style:u,className:"togglableContent"},e.children,r.a.createElement(W.a,{onClick:s},"cancel")))}));me.displayName="Togglable";var fe=me,pe={initializeUsers:_},de=Object(l.b)((function(e){return{users:e.users}}),pe)((function(e){var t=Object(l.c)();Object(a.useEffect)((function(){t(_())}),[t]);var n=Object(p.g)("/users/:id"),c=n?e.users.find((function(e){return e.id===n.params.id})):null;return c?r.a.createElement("div",null,r.a.createElement("h2",null,c.name," blogs:"),0===c.blogs.length?r.a.createElement("h3",null,"User has no blogs yet"):r.a.createElement("ul",null,c.blogs.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:e.id}," ",r.a.createElement(K,{blog:e})),r.a.createElement("br",null))})))):null})),ge=n(162),be=Object(d.a)({table:{minWidth:350}}),Ee={initializeUsers:_},he=Object(l.b)((function(e){return{users:e.users}}),Ee)((function(e){var t=be(),n=Object(l.c)();return Object(a.useEffect)((function(){n(_())}),[n]),r.a.createElement(q.a,{component:Q.a},r.a.createElement(X.a,{className:t.table,"aria-label":"simple table"},r.a.createElement(ge.a,null,r.a.createElement(Z.a,null,r.a.createElement($.a,null,"Users"),r.a.createElement($.a,{align:"left"},"Blogs created"))),r.a.createElement(Y.a,null,e.users.map((function(e){return r.a.createElement(Z.a,{key:e.id},r.a.createElement($.a,{component:"th",scope:"row"},r.a.createElement(i.b,{to:"/users/".concat(e.id)},e.username)),r.a.createElement($.a,{align:"left"},e.blogs.length))})))))})),ve={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Oe=JSON.parse(window.localStorage.getItem("loggedBlogappUser")),ye=Oe||null,we=function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ve.login({username:e,password:t});case 2:r=n.sent,a({type:"LOGIN",data:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},ke=n(163),xe={setNotification:G,initializeBlogs:I,initializeUsers:_,createBlog:C,removeBlog:L,addLikes:B,login:we,logout:function(){return{type:"LOGOUT"}}},Ne=Object(l.b)((function(e){return{blogs:e.blogs,users:e.users}}),xe)((function(e){var t=Object(a.useState)(""),n=Object(f.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),u=Object(f.a)(i,2),d=u[0],g=u[1],b=r.a.createRef(),E=Object(p.f)(),h=Object(l.c)(),v=Object(l.d)((function(e){return e.login}));Object(a.useEffect)((function(){h(I()),h(_())}),[h]),Object(a.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("loggedBlogappUser"));e&&S.setToken(e.token)}),[]),Object(a.useEffect)((function(){window.localStorage.setItem("loggedBlogappUser",JSON.stringify(v)),v&&S.setToken(v.token)}),[v]);var O=function(t){try{b.current.toggleVisibility(),h(C(t)),e.setNotification("Entry ".concat(t.title," was creaated"),"success",5)}catch(n){console.error(n),e.setNotification("Smth went wrong","error",5)}},w=function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!JSON.parse(window.localStorage.getItem("loggedBlogappUser")))try{a=h(we(c,d)),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),S.setToken(a.token)}catch(r){e.setNotification("Wrong credentials","error",5)}case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=Object(m.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{window.localStorage.removeItem("loggedBlogappUser",JSON.stringify(v)),e.logout(),E.push("/login")}catch(a){e.setNotification("Log out error","error",5)}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(ke.a,null,r.a.createElement("div",{style:{paddingBottom:"80px"}},r.a.createElement(se,null),r.a.createElement(ie,{user:v,handleLogout:j}),r.a.createElement(p.c,null,null===v?r.a.createElement(p.a,{path:"/login"},r.a.createElement(re,{username:c,password:d,handleUsernameChange:function(e){var t=e.target;return o(t.value)},handlePasswordChange:function(e){var t=e.target;return g(t.value)},handleSubmit:w})):r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{variant:"h3"},"Blogs"),r.a.createElement(y.a,{variant:"h5"},v.name," logged in"),r.a.createElement(p.a,{path:"/logout"}),r.a.createElement(p.a,{path:"/create"},r.a.createElement(fe,{buttonLabel:"new blog entry",ref:b},r.a.createElement(ne,{createBlogEntry:O}))),r.a.createElement(p.a,{exact:!0,path:"/blogs"},r.a.createElement(ee,null)),r.a.createElement(p.a,{path:"/blogs/:id",render:function(t){var n=t.match;return r.a.createElement(K,{blog:e.blogs.find((function(e){return e.id===n.params.id})),blogVisible:!0})}}),r.a.createElement(p.a,{exact:!0,path:"/users",render:function(){return r.a.createElement(he,null)}}),r.a.createElement(p.a,{path:"/users/:id",render:function(){return r.a.createElement(de,null)}})))),r.a.createElement(ae,null))})),Te=(n(104),n(33)),Se=n(65),Ie=n(66),Ce=Object(Te.combineReducers)({blogs:U,users:z,notification:V,login:je}),Be=Object(Te.createStore)(Ce,Object(Ie.composeWithDevTools)(Object(Te.applyMiddleware)(Se.a)));o.a.render(r.a.createElement(i.a,null,r.a.createElement(l.a,{store:Be},r.a.createElement(Ne,null))),document.getElementById("root"))},76:function(e,t,n){e.exports=n(105)}},[[76,1,2]]]);
//# sourceMappingURL=main.5cccc7ec.chunk.js.map